{% extends "base.html" %}
{% block content %}

<style>
  body {
  min-height: 100vh;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
}

/* üåà PAGE BACKGROUND */
.dashboard-wrapper {
  background: linear-gradient(135deg, var(--clr-bg) 0%, var(--clr-surface-alt) 100%);
  min-height: 100vh;
}

/* üì∞ NEWS TICKER */
.news-ticker {
  background: var(--clr-surface);
  border-bottom: 2px solid var(--clr-accent);
  padding: 12px 0;
  box-shadow: var(--shadow-sm);
}

.news-ticker marquee {
  color: var(--clr-text);
  font-size: 14px;
}

/* HEADER */
.dashboard-header {
  text-align: center;
  padding: 40px 20px 30px;
  animation: fadeInDown 0.6s ease-out;
}

.dashboard-title { color: var(--clr-text); font-size: 36px; font-weight: 700; }
.dashboard-subtitle { color: var(--clr-text-muted); }

/* üßä CARDS */
.admin-card {
  background: var(--clr-surface);
  border-radius: 16px;
  padding: 30px;
  box-shadow: var(--shadow-md);
  border: 1px solid rgba(0,0,0,.06);
  backdrop-filter: blur(10px);
  transition: .3s;
  animation: slideUp .6s ease-out;
  height: 100%;
}

[data-bs-theme="dark"] .admin-card { border-color: rgba(255,255,255,.08); }

.admin-card:hover { transform: translateY(-5px); }

/* CARD HEADER */
.card-header-custom {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:25px;
  padding-bottom:15px;
  border-bottom:1px solid var(--clr-surface-alt);
}

.card-header-custom h5 { color: var(--clr-text); }

.card-icon {
  width:40px; height:40px;
  background: var(--clr-accent-soft);
  border-radius:10px;
  display:flex; align-items:center; justify-content:center;
}

/* INPUT */
.form-control-custom {
  background: var(--clr-surface-alt);
  border: 1px solid rgba(0,0,0,.08);
  border-radius:10px;
  padding:12px 15px;
  color: var(--clr-text);
}

[data-bs-theme="dark"] .form-control-custom {
  border-color: rgba(255,255,255,.1);
}

.form-control-custom:focus {
  border-color: var(--clr-accent);
  box-shadow: 0 0 0 3px var(--clr-accent-soft);
}

/* BUTTONS */
.btn-primary-custom {
  background: var(--clr-accent);
  color:#fff;
  border-radius:10px;
  padding:10px 25px;
  font-weight:600;
  border: none;
  cursor: pointer;
  transition: all 0.3s;
  display: inline-block;
  text-decoration: none;
  text-align: center;
}

.btn-primary-custom:hover { 
  background: var(--clr-accent-hover);
  color: #fff;
}

.btn-outline-custom {
  border:1px solid var(--clr-accent);
  color:var(--clr-accent);
  background:transparent;
  border-radius:10px;
  padding:10px 25px;
  font-weight:600;
  cursor: pointer;
  transition: all 0.3s;
  display: inline-block;
  text-decoration: none;
  text-align: center;
}

.btn-outline-custom:hover { 
  background: var(--clr-accent-soft);
  color:var(--clr-accent);
}

.btn-warning-custom { 
  background: var(--clr-gold); 
  color:#fff;
  border: none;
  border-radius:10px;
  padding:8px 15px;
  font-weight:600;
  cursor: pointer;
  transition: all 0.3s;
  display: inline-block;
  text-decoration: none;
  font-size: 14px;
  margin-right: 5px;
}

.btn-warning-custom:hover {
  opacity: 0.9;
  color: #fff;
}

.btn-danger-custom { 
  background:#e53935; 
  color:#fff;
  border: none;
  border-radius:10px;
  padding:8px 15px;
  font-weight:600;
  cursor: pointer;
  transition: all 0.3s;
  display: inline-block;
  text-decoration: none;
  font-size: 14px;
}

.btn-danger-custom:hover {
  opacity: 0.9;
  color: #fff;
}

.btn-success-custom { 
  background: var(--clr-green); 
  color:#fff;
  border: none;
  border-radius:10px;
  padding:10px 25px;
  font-weight:600;
  cursor: pointer;
  transition: all 0.3s;
  display: inline-block;
  text-decoration: none;
}

.btn-success-custom:hover {
  opacity: 0.9;
  color: #fff;
}

/* NEWS ITEM */
.news-item {
  background: var(--clr-surface-alt);
  border-radius:10px;
  padding:15px;
  margin-bottom:12px;
  display:flex;
  justify-content:space-between;
  align-items: center;
}

.news-item span { 
  color: var(--clr-text);
  flex: 1;
  margin-right: 15px;
}

.action-buttons {
  display: flex;
  gap: 8px;
  flex-shrink: 0;
}

/* QUICK ACTION */
.quick-action-card {
  background: var(--clr-surface-alt);
  border-radius:12px;
  padding:20px;
  text-align:center;
  transition:.3s;
}

.quick-action-card:hover {
  background: var(--clr-accent-soft);
  transform: translateY(-3px);
}

.quick-action-card h5 { color: var(--clr-text); }

/* EMPTY STATE */
.empty-state { text-align:center; padding:30px; color:var(--clr-text-muted); }

/* ANIMATIONS */
@keyframes fadeInDown { from{opacity:0;transform:translateY(-20px);} to{opacity:1;} }
@keyframes slideUp { from{opacity:0;transform:translateY(30px);} to{opacity:1;} }

</style>

{% if news_list %}
<div class="news-ticker">
    <marquee direction="left" scrollamount="6">
        {% for n in news_list %}
            üîî {{ n.content }} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        {% endfor %}
    </marquee>
</div>
{% endif %}

<div class="dashboard-header">
    <h3 class="dashboard-title">Institution Admin Dashboard</h3>
    <p class="dashboard-subtitle">Manage your institution's settings and data here</p>
</div>

<div class="container" style="max-width: 1200px; padding-bottom: 50px;">
    <div class="row g-4">
        <!-- ADD / EDIT NEWS -->
        <div class="col-lg-5">
            <div class="admin-card">
                <div class="card-header-custom">
                    <h5>{% if edit_news %}‚úèÔ∏è Edit News{% else %}üì∞ Add News{% endif %}</h5>
                    <div class="card-icon">üì¢</div>
                </div>

                <form method="post">
                    {% csrf_token %}

                    {% if edit_news %}
                    <input type="hidden" name="news_id" value="{{ edit_news.id }}">
                    {% endif %}

                    <textarea 
                        name="news"
                        class="form-control-custom mb-3"
                        rows="5"
                        placeholder="Enter news content here..."
                        required>{{ edit_news.content|default_if_none:"" }}</textarea>

                    <button class="btn-primary-custom w-100" type="submit">
                        {% if edit_news %}‚úì Update News{% else %}‚úì Publish News{% endif %}
                    </button>
                </form>
            </div>
        </div>

        <!-- NEWS LIST -->
        <div class="col-lg-7">
            <div class="admin-card">
                <div class="card-header-custom">
                    <h5>üìã Published News</h5>
                    <span style="color: rgba(255, 255, 255, 0.5); font-size: 14px;">
                        {{ news_list|length }} item{{ news_list|length|pluralize }}
                    </span>
                </div>

                <div style="max-height: 400px; overflow-y: auto; padding-right: 5px;">
                    {% if news_list %}
                        {% for n in news_list %}
                        <div class="news-item">
                            <span>{{ n.content }}</span>
                            <div class="action-buttons">
                                <a href="?edit={{ n.id }}" class="btn-warning-custom">‚úèÔ∏è Edit</a>
                                <a href="{% url 'delete_news' n.id %}" class="btn-danger-custom" 
                                   onclick="return confirm('Are you sure you want to delete this news?')">
                                    üóëÔ∏è Delete
                                </a>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="empty-state">
                            <div class="empty-state-icon">üì∞</div>
                            <p>No news published yet. Add your first news item!</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% comment %} add courses {% endcomment %}
        <div class="col-lg-6">
            <div class="admin-card">
                <div class="quick-action-card">
                    <h5>üì∞ Add Courses</h5>
                    <p style="color: rgba(255, 255, 255, 0.6); font-size: 13px; margin-bottom: 15px;">
                        Add, edit, or remove courses from your institution
                    </p>
                    <a href="{% url 'course_list' %}" class="btn-outline-custom">Go to Courses</a>
                </div>
            </div>
        </div>
        <!-- Quick Actions -->
        <div class="col-lg-6">
            <div class="admin-card">
                <div class="quick-action-card">
                    <h5>üë®‚Äçüè´ Manage Teachers</h5>
                    <p style="color: rgba(255, 255, 255, 0.6); font-size: 13px; margin-bottom: 15px;">
                        Add, edit, or remove teachers from your institution
                    </p>
                    <a href="{% url 'teacher_list' %}" class="btn-outline-custom">Go to Teachers</a>
                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="admin-card">
                <div class="quick-action-card">
                    <h5>üë®‚Äçüéì Manage Students</h5>
                    <p style="color: rgba(255, 255, 255, 0.6); font-size: 13px; margin-bottom: 15px;">
                        Add, edit, or remove students from your institution
                    </p>
                    <a href="#" class="btn-outline-custom">Go to Students</a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
  // Smooth scroll for news list
  document.addEventListener('DOMContentLoaded', function() {
    const newsContainer = document.querySelector('.news-item');
    if (newsContainer) {
      newsContainer.style.animation = 'slideUp 0.6s ease-out';
    }
  });

  // Form submission animation
  document.querySelector('form').addEventListener('submit', function() {
    const button = this.querySelector('button[type="submit"]');
    button.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Processing...';
    button.disabled = true;
  });
</script>

{% endblock %}

